# Hinemos MCP Server 使用例

## 基本的な使用例

### 1. ノード管理

#### ノード一覧の表示
```
Hinemosのノード一覧を表示してください
```

**期待される応答**:
Claude がリソース `hinemos://repository/nodes` にアクセスして、現在登録されているノードの一覧を表示します。

#### 特定ノードの詳細確認
```
ノード「WEB1」の詳細情報を教えてください
```

**期待される応答**:
Claude が `hinemos_get_repository_node` ツールを使用して、指定されたノードの詳細情報を取得します。

#### 新しいノードの追加
```
新しいWebサーバー（IPアドレス: 192.168.1.100）をリポジトリに追加してください。
ファシリティID: WEB_SERVER_02
ファシリティ名: Web Server 02
説明: 本番環境のWebサーバー
プラットフォーム: LINUX
```

**期待される応答**:
Claude が `hinemos_create_repository_node` ツールを使用して新しいノードを作成します。

#### ノード情報の更新
```
ノード「WEB_SERVER_02」の説明を「更新されたWebサーバー」に変更してください
```

### 2. 監視設定管理

#### 監視設定一覧の表示
```
現在設定されている監視項目を一覧表示してください
```

#### 特定監視設定の詳細確認
```
監視設定「PING_MONITOR_01」の詳細を教えてください
```

#### Ping監視の作成
```
ノード「WEB1」に対してPing監視を設定してください。
監視ID: PING_WEB1_CHECK
説明: Web1サーバーのPing監視
実行回数: 3回
タイムアウト: 5秒
監視間隔: 5分
```

#### HTTP応答時間監視の作成
```
ノード「WEB1」のHTTP応答時間を監視してください。
URL: http://web1.example.com/health
監視ID: HTTP_RESPONSE_WEB1
説明: Web1のHTTP応答時間監視
```

#### HTTP文字列監視の作成
```
ノード「WEB1」のWebサイトで「OK」という文字列が含まれているかチェックしてください。
URL: http://web1.example.com/status
監視ID: HTTP_STATUS_WEB1
「OK」が見つかった場合: INFO
「ERROR」が見つかった場合: CRITICAL
```

#### SNMP監視の作成
```
サーバー「SERVER01」のCPU使用率をSNMPで監視してください。
OID: 1.3.6.1.2.1.25.3.3.1.2.1
監視ID: SNMP_CPU_SERVER01
```

#### ログファイル監視の作成
```
アプリケーションサーバー「APP01」のログファイルでエラーを監視してください。
ディレクトリ: /var/log/application
ファイル名: app.log
監視ID: LOG_ERROR_APP01
「ERROR」パターンでCRITICAL
「WARNING」パターンでWARNING
```

## 応用的な使用例

### 3. バッチ操作

#### 複数ノードの一括追加
```
以下のWebサーバーを一括でリポジトリに追加してください：

1. WEB_SERVER_03, IP: 192.168.1.103, Web Server 03
2. WEB_SERVER_04, IP: 192.168.1.104, Web Server 04  
3. WEB_SERVER_05, IP: 192.168.1.105, Web Server 05

すべてLINUXプラットフォームです。
```

#### 複数監視の一括設定
```
先ほど追加したWebサーバー（WEB_SERVER_03, 04, 05）に対して、
それぞれPing監視とHTTP監視を設定してください。

Ping監視:
- 監視間隔: 5分
- 実行回数: 3回

HTTP監視:
- URL: http://{ip_address}/health
- 監視間隔: 10分
```

### 4. 問題調査・分析

#### 監視状況の確認
```
現在エラーが発生している監視項目はありますか？
または直近で問題があった監視項目を教えてください。
```

#### ノード関連の監視設定確認
```
ノード「WEB1」に設定されているすべての監視項目を一覧表示してください
```

#### 監視タイプ別の統計
```
現在設定されている監視項目を監視タイプ別に分類して、
それぞれの件数を教えてください
```

### 5. メンテナンス作業

#### 一時的な監視無効化（例）
```
メンテナンス作業のため、ノード「WEB1」の監視を一時的に無効化したいです。
該当する監視項目を確認して、無効化の手順を教えてください。
```

#### 監視設定の最適化提案
```
現在の監視設定を確認して、以下の観点で改善提案をしてください：
1. 監視間隔が適切かどうか
2. 重複している監視項目
3. 不足している監視項目
```

## 実際のワークフロー例

### Webサイト監視の完全セットアップ

```
新しいWebサイトの監視をセットアップしたいです。

サーバー情報:
- サーバー名: PROD_WEB_01
- IPアドレス: 10.0.1.100
- プラットフォーム: LINUX
- 説明: 本番環境Webサーバー1号機

必要な監視:
1. Ping監視（5分間隔）
2. HTTP応答時間監視（http://10.0.1.100/）
3. HTTP文字列監視（「Service Available」が含まれることを確認）
4. ログファイル監視（/var/log/apache2/error.log でERRORパターン）

これらを順番に設定してください。
```

### 障害対応時の情報収集

```
システム障害が発生しています。以下の情報を収集してください：

1. 現在エラー状態の監視項目一覧
2. 「WEB」で始まるすべてのノードの監視状況
3. 直近30分でアラートが発生した監視項目
4. 重要なサービス（HTTP監視）の状態

情報を整理して報告してください。
```

## Claude との対話のコツ

### 効果的な指示の出し方

#### ✅ 良い例
```
ノード「WEB1」にPing監視を設定してください。
監視ID: PING_WEB1
監視間隔: 5分
ping回数: 3回
```

#### ❌ 悪い例
```
何か監視を設定して
```

### パラメータの指定方法

#### ✅ 明確な指定
```
HTTP監視を作成：
- URL: http://example.com/api/health
- タイムアウト: 15秒
- 監視間隔: 10分
```

#### ✅ デフォルト値の利用
```
基本的なPing監視を設定してください（デフォルト設定で）
```

### エラー時の対応

#### 認証エラー時
```
Hinemosへの接続でエラーが発生しました。
認証情報を確認してください。
```

#### 設定エラー時
```
監視設定の作成に失敗しました。
パラメータを確認して再試行してください。
```

## 注意事項

1. **監視ID の重複**: 既存の監視IDと重複しないよう注意
2. **ファシリティIDの確認**: 存在するノードIDを指定
3. **URL の有効性**: HTTP監視のURLが正しくアクセス可能であることを確認
4. **OID の妥当性**: SNMP監視のOIDが対象機器でサポートされていることを確認
5. **ファイルパス**: ログファイル監視のパスが実際に存在することを確認